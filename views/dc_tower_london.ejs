<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta property="og:title" content="<%= title %>" />
    <meta property="og:description" content="Don't say I don't look after you... tower london are offering an exclusive 10% discount across their site when you buy from their store using my personal referral link. Thank me later!" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="<%= imageUrl %>" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css">
    <style>
      @import url("https://fonts.googleapis.com/css?family=Roboto:500,900");
      html,
      body {
        height: 100%;
      }

      html {
        box-sizing: border-box;
      }

      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }

      body {
        margin: 0px;
        display: flex;
        flex-direction: column;
        font-family: Roboto;
      }

      .background {
        background: url("https://s3-eu-west-1.amazonaws.com/dist.soreto.com/clientsrc/assets/tower_london/background_towerlondon.jpg");
        background-color: grey;
        flex-grow: 1;
        flex-shrink: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        background-position: center center;
        background-size: cover;
      }
      .background .content-container {
        display: flex;
        justify-content: center;
        background: #f1f1f1de;
        min-height: 65vh;
        padding: 55px 10px;
        max-width: 100vw;
      }
      .background .content-container .content {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-content: center;
        text-align: center;
        font-weight: 500;
        font-size: 22px;
        line-height: 1.32;
      }
      .background .content-container .content .first-p {
        margin: 10px 30px;
      }
      .background .content-container .content .first-p .success {
        margin-top: 20px;
        font-weight: 900;
        line-height: 2;
      }
      .background .content-container .content .second-p {
        margin-top: 20px;
      }
      .background .content-container .content .second-p .reward {
        font-weight: 900;
        font-size: 32px;
      }
      .background .content-container .content .code-btn {
        background: green;
        background: url("https://s3-eu-west-1.amazonaws.com/dist.soreto.com/clientsrc/assets/tower_london/get_code_button.svg");
        background-size: contain;
        background-repeat: no-repeat;
        width: 300px;
        height: 65px;
        margin: 30px auto 0px;
      }
      @media (min-width: 1025px) {
        .background .content-container {
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          justify-content: flex-end;
          height: 100%;
          padding-right: 15vw;
          background-blend-mode: multiply;
          color: white;
          /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#000000+25,000000+56&0+25,0.9+72 */
          background: -moz-linear-gradient(left, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 0.59) 56%, rgba(0, 0, 0, 0.7) 72%);
          /* FF3.6-15 */
          background: -webkit-linear-gradient(left, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 0.59) 56%, rgba(0, 0, 0, 0.7) 72%);
          /* Chrome10-25,Safari5.1-6 */
          background: linear-gradient(to right, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 0.59) 56%, rgba(0, 0, 0, 0.7) 72%);
          /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
          filter: progid:DXImageTransform.Microsoft.gradient( startColorstr="#00000000", endColorstr="#e6000000", GradientType=1 );
          /* IE6-9 */
        }
        .background .content-container .mobile.logo {
          display: none;
        }
        .background .content-container .content {
          min-width: 420px;
          width: 32vw;
        }
        .background .content-container .content .content-text {
          font-size: 1.8vw;
        }
        .background .content-container .content .content-text .reward {
          font-size: 3vw;
        }
        .background .content-container .content .content-text .first-p {
          margin-bottom: 30px;
        }
      }

      .intersital-wrapper {
        flex-grow: 1;
        flex-shrink: 0;
        display: flex;
      }

      .footer {
        flex-shrink: 0;
        height: 56px;
        width: 100%;
        color: #0000008f;
        background: #f0efee;
        display: flex;
        justify-content: center;
        align-content: center;
        align-items: center;
        font-size: 13px;
      }
      .footer a{
        color: #0000008f;
      }
      .footer div {
        margin: 0px 35px;
      }
      .footer .footer-divide {
        flex-grow: 1;
      }

      @media (max-width: 1025px) {
        .desktop {
          display: none;
        }

        .footer div {
          margin: 0px 0px;
        }

        .footer {
          text-align: center;
          flex-direction: column;
        }
        .footer .footer-divide {
          display: none;
        }
      }
      .desktop.logo {
        position: absolute;
        top: 30px;
        left: 30px;
      }

      .logo {
        background: url("https://s3-eu-west-1.amazonaws.com/dist.soreto.com/clientsrc/assets/tower_london/logo_towerlondon.svg");
        margin: 0px auto;
        background-size: cover;
        width: 131px;
        height: 171px;
      }

      .modal {
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        opacity: 0;
        visibility: hidden;
        transform: scale(1.1);
        transition: visibility 0s linear 0.25s, opacity 0.25s 0s, transform 0.25s;
      }
      .modal.show-modal {
        opacity: 1;
        visibility: visible;
        transform: scale(1);
        transition: visibility 0s linear 0s, opacity 0.25s 0s, transform 0.25s;
      }
      .modal .modal-content {
        letter-spacing: .02px;
        text-align: center;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        padding: 1rem 1.5rem;
        height: 60%;
        width: 600px;
      }
      .modal .modal-content .logo {
        margin: auto 0px;
        margin-top: 15px;
      }
      .modal .close-button {
        float: right;
        width: 1.5rem;
        line-height: 1.5rem;
        text-align: center;
        cursor: pointer;
        border-radius: 0.25rem;
        background-color: lightgray;
      }
      .modal .close-button:hover {
        background-color: darkgray;
      }
      .modal .modal-container-customer {
        position: relative;
        margin-bottom: 0;
        color: #50cf98;
        font-size: 1em;
        font-weight: 500;
      }
      .modal .modal-content {
        width: 80%;
        max-width: 800px;
        min-height: 450px;
        max-height: 450px;
        min-width: 300px;
      }
      .modal .modal-container-img {
        margin: auto 0px;
      }
      .modal .modal-container-details {
        margin-top: 2rem;
        width: 100%;
      }
      .modal .modal-container-discount {
        text-align: center;
        font-weight: 300;
      }
      .modal .modal-container-codigo {
        border-radius: 10px;
        height: 50px;
        background-color: #fff6e7;
        border: 1px solid #ffc178;
        font-size: 1.1em;
        font-weight: 700;
        color: #040303;
        text-align: center;
        line-height: 50px;
        margin: auto;
      }
      .modal .modal-container-footer {
        text-align: center;
        position: fixed;
        width: 100%;
        text-align: center;
        margin-bottom: 0;
        background-color: #f0efee;
        position: absolute;
        bottom: 0px;
        left: 0px;
        padding: 10px;
        font-size: 9px;
      }
      @media (min-width: 1025px) {
        .modal .modal-content {
          width: 80%;
          max-width: 650px;
          min-height: 280px;
          max-height: 280px;
          min-width: 300px;
        }
        .modal .modal-container-img {
          width: 400px;
        }
        .modal .modal-container {
          display: flex;
          justify-content: center;
          align-content: center;
          align-items: flex-start;
        }
      }

    </style>
  </head>
  <body>

    <div class='intersital-wrapper'>
      <div class='background'>
        <div class='desktop logo'></div>
    
        <div class='content-container'>
          <div class='content'>
            <div class='mobile logo'></div>
            <div class='content-text'>
              <div class='first-p'>
                <div class='success'>Success!</div>
                You’ve shopped using <span class='name'>name</span> exclusive referral link
    
              </div>
              <div class='second-p'>
                Click below to get a
    
                <div class='reward'>TIDY 10% OFF
    
                </div>
                indie footwear retailer TOWER London
    
              </div>
              <div class='code-btn'></div>
    
            </div>
    
          </div>
        </div>
    
      </div>
    </div>
    <div class='footer'>
      <div class='term'>
        <a href="https://soreto.com/terms-and-conditions/" >Terms & Conditions</a> | <a href="https://soreto.com/privacy-policy/" >Privacy Policy</a>
      </div>
      <div class='footer-divide'></div>
      <div class='powerd-by'>Tower London’s official referral program powered by Soreto
      </div>
    </div>
    
    <div class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <div class="modal-container">
    
          <div class="modal-container-img" align="center">
            <div class='logo'></div>
          </div>
          <div class="modal-container-details">
            <h5 class="modal-container-discount">Your EXCLUSIVE 10% off is below</h5>
            <div class="modal-container-codigo">
              <%= discountCode %>
            </div>
            <h6 class="modal-container-customer">Continue at <a href="<%= productUrl %>" target="_blank">tower-london.com</a></h6>
          </div>
    
        </div>
        <div class="modal-container-footer">Tower London official referral program powered by Soreto</div>
      </div>
    </div>
   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    
    <script>  
      $(document).ready(function() {
        var modal = document.querySelector('.modal');
        var queries = {};
        
        $.each(document.location.search.substr(1).split('&'),function(c,q){
          if (q !== '' && q !== undefined) {
            var i = q.split('=');
            queries[i[0].toString()] = i[1].toString();
          }
        });
        
        $('.code-btn').on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          var self = this;
          var redirect = function(){
            window.open('?showcode=true', '_blank'); 
            window.open('<%= productUrl %>', '_self');        
          }
          sendTracking('interstitial-cta','true',redirect())
        });

        $('.close-button').on('click', function(e) {
          toggleModal();
        });

        if(queries && queries['showcode']){
          toggleModal();
        }
        else {
          onLoad();
        }

        function toggleModal() {          
          modal.classList.toggle('show-modal');
        }

      });

      function onLoad(){
        sendTracking('interstitial-loaded','true')
      }

      function sendTracking(trackingString,value,cb){
        var xhttp = new XMLHttpRequest();
        xhttp.open("POST", "<%= apiBaseUrl %>/api/v1/tracking", true);
        xhttp.withCredentials = true;
        xhttp.setRequestHeader("Content-type", "application/json");
        xhttp.send(JSON.stringify({clientId:"<%= clientId %>",type: trackingString ,value: value }));
        xhttp.onreadystatechange = function() {
          if (xhttp.readyState === 4) {
            if(cb){
            cb();
            }
            return;
          }
        }
      }
    </script>

  </body>
</html>
